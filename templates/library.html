{% extends "base.html" %} {% block title %}Library{% endblock %} {% block
content%}
<!--  -->

<div class="container px-4 py-4">
  <div class="row g-4">
    <div class="col-12 col-md-6 col-lg-4 d-flex">
      <div class="stats pb-4 h-100 flex-column">
        <h3
          class="fs-2 lib-link"
          style="
            color: #506e9a !important;
            font-size: 15px !important;
            font-weight: bold;
          "
        >
          Film Totals / Watchtime
        </h3>
        <div>
          <h1 class="pricing-card-title" style="font-size: 2.5rem">
            681<small
              class="text-body-secondary fw-light"
              style="color: #7e7f83 !important; font-size: 20px"
            >
              /56hrs 34mins</small
            >
          </h1>
          <p
            class="text-body-secondary fw-light"
            style="color: #7e7f83 !important; font-size: 0.75rem !important"
          >
            These are the movies you have in your library. You can add or remove
            directories or rescan them for newly added movies.
          </p>
        </div>
        <div class="gap-2">
          <button class="btn btn-primary me-3 mt-2">
            <a
              style="
                font-weight: bold;
                font-size: 0.75rem;
                padding: 0.4rem 0.2rem !important;
                color: #e7ecef !important;
              "
              href="#"
              >Scan Directories </a
            ><i
              class="bi bi-upc-scan"
              style="
                color: #e7ecef !important;
                font-weight: bold;
                font-size: 12px;
              "
            ></i>
          </button>
          <button
            class="btn btn-outline-light mt-2"
            style="border: 1px solid #7e7f83 !important"
          >
            <a
              style="
                font-weight: bold;
                font-size: 0.75rem;
                padding: 0.4rem 0.2rem !important;
              "
              href="#"
              >Add Directory</a
            >
          </button>
        </div>
        <div class="watch-bars mt-4">
          <ul class="nav nav-pills">
            <li
              class=""
              style="
                padding: none !important;
                margin: none !important;
                margin-right: 2rem;
              "
            >
              <a
                class=""
                style="
                  padding: none !important;
                  margin: none !important;
                  color: #799aa7 !important;
                  font-weight: bold;
                  font-size: 0.75rem;
                "
                aria-current="page"
                href="#"
                >By type</a
              >
            </li>
            <li class="">
              <a
                class=""
                style="
                  padding: none !important;
                  margin: none !important;
                  font-weight: bold;
                  font-size: 0.75rem;
                  color: #506e9a !important;
                "
                href="#"
                >By genre</a
              >
            </li>
          </ul>
          <div class="breakdown mt-3">
            <p
              style="
                font-size: 0.75rem !important;
                color: #7e7f83;
                margin-bottom: 0.5rem;
              "
            >
              Sequels:
              <bold style="font-weight: bold; font-size: 0.8rem; color: #799aa7"
                >192</bold
              >
              films
            </p>
            <div class="progress" style="height: 5px">
              <div
                class="progress-bar"
                role="progressbar"
                style="width: 29%"
              ></div>
            </div>
          </div>
          <div class="breakdown mt-3">
            <p
              style="
                font-size: 0.75rem !important;
                color: #7e7f83;
                margin-bottom: 0.5rem;
              "
            >
              Originals:
              <bold style="font-weight: bold; font-size: 0.8rem; color: #799aa7"
                >425</bold
              >
              films
            </p>
            <div class="progress" style="height: 5px">
              <div
                class="progress-bar"
                role="progressbar"
                style="width: 62%"
              ></div>
            </div>
          </div>
          <div class="breakdown mt-3">
            <p
              style="
                font-size: 0.75rem !important;
                color: #7e7f83;
                margin-bottom: 0.5rem;
              "
            >
              Adaptations:
              <bold style="font-weight: bold; font-size: 0.8rem; color: #799aa7"
                >64</bold
              >
              films
            </p>
            <div class="progress" style="height: 5px">
              <div
                class="progress-bar"
                role="progressbar"
                style="width: 9%"
              ></div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="col-12 col-md-6 col-lg-4 d-flex">
      <div class="stats pb-4 h-100 flex-column">
        <h3
          class="fs-2 lib-link"
          style="
            color: #506e9a !important;
            font-size: 15px !important;
            font-weight: bold;
          "
        >
          Watchlist Totals / Watchtime
        </h3>
        <div>
          <h1 class="pricing-card-title" style="font-size: 2.5rem">
            51<small
              class="text-body-secondary fw-light"
              style="color: #7e7f83 !important; font-size: 20px"
            >
              /26hrs 16mins</small
            >
          </h1>
          <p
            class="text-body-secondary fw-light"
            style="color: #7e7f83 !important; font-size: 0.75rem !important"
          >
            These are the total watchlists in your library; both automatically
            generated and custom. You can add or rescan directories.
          </p>
        </div>
        <div class="gap-2">
          <button class="btn btn-primary me-3 mt-2">
            <a
              style="
                font-weight: bold;
                font-size: 0.75rem;
                padding: 0.4rem 0.2rem !important;
                color: #e7ecef !important;
              "
              href="#"
              >Scan Directories </a
            ><i
              class="bi bi-upc-scan"
              style="
                color: #e7ecef !important;
                font-weight: bold;
                font-size: 12px;
              "
            ></i>
          </button>
          <button
            class="btn btn-outline-light mt-2"
            style="border: 1px solid #7e7f83 !important"
          >
            <a
              style="
                font-weight: bold;
                font-size: 0.75rem;
                padding: 0.4rem 0.2rem !important;
              "
              href="#"
              >Add Directory</a
            >
          </button>
        </div>
        <div class="watch-bars mt-4">
          <ul class="nav nav-pills">
            <li
              class=""
              style="
                padding: none !important;
                margin: none !important;
                margin-right: 2rem;
              "
            >
              <a
                class=""
                style="
                  padding: none !important;
                  margin: none !important;
                  color: #799aa7 !important;
                  font-weight: bold;
                  font-size: 0.75rem;
                "
                aria-current="page"
                href="#"
                >By type</a
              >
            </li>
            <li class="">
              <a
                class=""
                style="
                  padding: none !important;
                  margin: none !important;
                  font-weight: bold;
                  font-size: 0.75rem;
                  color: #506e9a !important;
                "
                href="#"
                >By genre</a
              >
            </li>
          </ul>
          <div class="breakdown mt-3">
            <p
              style="
                font-size: 0.75rem !important;
                color: #7e7f83;
                margin-bottom: 0.5rem;
              "
            >
              Marathons:
              <bold style="font-weight: bold; font-size: 0.8rem; color: #799aa7"
                >10</bold
              >
              watchlists
            </p>
            <div class="progress" style="height: 5px">
              <div
                class="progress-bar"
                role="progressbar"
                style="width: 20%"
              ></div>
            </div>
          </div>
          <div class="breakdown mt-3">
            <p
              style="
                font-size: 0.75rem !important;
                color: #7e7f83;
                margin-bottom: 0.5rem;
              "
            >
              TV Shows:
              <bold style="font-weight: bold; font-size: 0.8rem; color: #799aa7"
                >23</bold
              >
              shows
            </p>
            <div class="progress" style="height: 5px">
              <div
                class="progress-bar"
                role="progressbar"
                style="width: 45%"
              ></div>
            </div>
          </div>
          <div class="breakdown mt-3">
            <p
              style="
                font-size: 0.75rem !important;
                color: #7e7f83;
                margin-bottom: 0.5rem;
              "
            >
              Franchises:
              <bold style="font-weight: bold; font-size: 0.8rem; color: #799aa7"
                >18</bold
              >
              watchlists
            </p>
            <div class="progress" style="height: 5px">
              <div
                class="progress-bar"
                role="progressbar"
                style="width: 35%"
              ></div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="col-12 col-md-12 col-lg-4 d-flex">
      <div class="stats pb-4 h-100 flex-column w-100">
        <h3
          class="fs-2 lib-link"
          style="
            color: #506e9a !important;
            font-size: 15px !important;
            font-weight: bold;
          "
        >
          Films by Genre
        </h3>
        <canvas id="pieChart" width="10" height="10"></canvas>
      </div>
    </div>
  </div>
</div>

<!-- Tabs -->

<!-- Genres Tab -->
<div class="container pt-3 mt-5">
  <ul
    class="nav navbar nav-pills d-flex gap-2 justify-content-center"
    id="genre-tabs"
    role="tablist"
  >
    <li class="nav-item" role="presentation">
      <button
        class="nav-link active"
        id="all-tab"
        data-bs-toggle="pill"
        type="button"
        role="tab"
      >
        All
      </button>
    </li>
    {% for genre, icon in genres %}
    <li class="nav-item" role="presentation">
      <button
        class="nav-link"
        id="{{ genre|lower }}-tab"
        data-bs-toggle="pill"
        type="button"
        role="tab"
      >
        <img
          src="../static/img/{{ icon }}"
          alt="{{ genre }} icon"
          style="width: 20px; height: 20px; margin-right: 5px"
        />
        {{ genre }}
      </button>
    </li>
    {% endfor %}
    <!-- Add more genres if you want -->
  </ul>
</div>

<div class="container px-4">
  <div class="d-flex flex-column align-items-stretch">
    <div class="d-flex flex-fill align-items-center gap-4 py-3 mx-4">
      <div class="align-items-center">
        <img
          src="../static/img/filter.png"
          alt="Filter"
          style="width: 20px; height: 20px"
        />
        <img
          src="../static/img/sort-arrows-couple-pointing-up-and-down.png"
          alt="Sort"
          style="width: 20px; height: 20px"
        />
      </div>
      <p class="mb-0" style="font-size: 0.75rem !important;">MOVIES, RECENTLY ADDED, SCI-FI, ANIMATION (6)</p>

      <div class="align-items-center" style="margin-left: auto">
        <img
          src="../static/img/grid.png"
          alt="Grid"
          style="width: 20px; height: 20px"
        />
        <img
          src="../static/img/view.png"
          alt="View"
          style="width: 20px; height: 20px"
        />
      </div>
    </div>
  </div>
</div>



  <div class="container px-4 py-4">
    <div class="">
      <div class="list-group d-flex flex-column align-items-stretch">
        {% for movie in movies %}
        <a
          href="#"
          class="list-group-item list-group-item-action d-flex flex-fill align-items-center gap-3 py-3"
          aria-current="true"
          style="border-radius: none !important"
        >
          <!-- Checkbox -->
          <input
            class="form-check-input flex-shrink-0"
            type="checkbox"
            value=""
            id="flexCheckDefault"
            style="
              width: 0.75rem !important;
              height: 0.75rem !important;
              margin-right: 0.5rem !important;
              border-radius: 25%;
              background-color: #506e9a;
              border: none !important;
            "
          />
          <!-- Poster -->
          <img
            src="../static/posters/{{ movie.poster_main }}"
            alt=""
            width="32"
            height="50"
            class="flex-shrink-0"
          />

          <!-- Full row content -->
          <div class="align-items-center">
            <!-- Title + Details (only this grows and truncates) -->
            <div class="overflow-hidden gap-4">
              <h6
                class="mb-0 text-truncate"
                style="color: #e7ecef !important; font-weight: bold"
              >
                {{ movie.title }}
              </h6>
              <small
                class="mb-0 opacity-75 text-muted d-block mt-1 text-truncate"
                style="
                  color: #7e7f83 !important;
                  font-weight: bold;
                  font-size: 0.75rem !important;
                "
                >{{ movie.year }} • {{ movie.genres[0] }} • {{ movie.runtime
                }}</small
              >
            </div>

            <div class="overflow-hidden px-4 gap-4">
              <div class="px-3 gap-2">
                <img
                  class="mb-0"
                  src="../static/img/imdb.png"
                  style="height: 1rem"
                  alt="IMDb"
                />
                <small
                  style="font-weight: bold; color: #7e7f83; font-size: 0.75rem"
                  >{{ movie.imdb_rating }}</small
                >
              </div>
              <div class="px-3 gap-2">
                <img
                  class="mb-0"
                  src="../static/img/rotten.png"
                  style="height: 1rem"
                  alt="Rotten Tomatoes"
                />
                <small
                  style="font-weight: bold; color: #7e7f83; font-size: 0.75rem"
                  >{{ movie.rotten_tomatoes_rating }}%</small
                >
              </div>
            </div>
            <div class="overflow-hidden px-4 gap-4">
              <h6
                class="mb-0 text-truncate"
                style="
                  color: #ff7742 !important;
                  font-weight: bold;
                  font-size: 0.75rem !important;
                "
              >
                {{ movie.watched }}x
              </h6>
              <small
                class="mb-0 opacity-75 text-muted d-block mt-1 text-truncate"
                style="
                  color: #506e9a !important;
                  font-weight: bold;
                  font-size: 0.75rem !important;
                "
                >Rank:
                <b style="color: #e7ecef !important; font-weight: bold"
                  >{{ movie.ranking }}</b
                >/{{ num_of_movies }}</small
              >
            </div>

            <div class="overflow-hidden px-4 gap-4">
              <h6
                class="mb-0 text-truncate"
                style="
                  color: #7e7f83 !important;
                  font-weight: bold;
                  font-size: 0.75rem !important;
                "
              >
                {{ movie.directors | join(', ') }}
              </h6>
              <small
                class="mb-0 opacity-75 text-muted d-block mt-1 text-truncate"
                style="
                  color: #506e9a !important;
                  font-weight: bold;
                  font-size: 0.75rem !important;
                "
                >Rank:
                <b style="color: #e7ecef !important; font-weight: bold"
                  >{{ directors_dict.get(movie.directors[0], 'N/A') }}</b
                >/{{ num_of_directors }}</small
              >
            </div>

            <div class="px-4 gap-4" style="margin-left: auto">
              <div class="">
                <img
                  class="mb-0"
                  src="../static/img/edit-button.png"
                  style="height: 0.85rem; margin: 0.2rem"
                  alt="Edit"
                />
                <img
                  class="mb-0"
                  src="../static/img/more.png"
                  style="height: 0.85rem; margin: 0.2rem"
                  alt="More"
                />
              </div>
            </div>
          </div>
        </a>
        {% endfor %}
      </div>
    </div>
  </div>
  <!-- Extra details below title -->


<!-- Genres Tab -->
<div class="container pt-3 mt-5">
  <ul
    class="nav navbar nav-pills d-flex gap-2 justify-content-center"
    id="genre-tabs"
    role="tablist"
  >
    <li class="nav-item" role="presentation">
      <button
        class="nav-link active"
        id="all-tab"
        data-bs-toggle="pill"
        type="button"
        role="tab"
      >
        All
      </button>
    </li>
    {% for genre, icon in genres %}
    <li class="nav-item" role="presentation">
      <button
        class="nav-link"
        id="{{ genre|lower }}-tab"
        data-bs-toggle="pill"
        type="button"
        role="tab"
      >
        <img
          src="../static/img/{{ icon }}"
          alt="{{ genre }} icon"
          style="width: 20px; height: 20px; margin-right: 5px"
        />
        {{ genre }}
      </button>
    </li>
    {% endfor %}
    <!-- Add more genres if you want -->
  </ul>
</div>

<div class="container px-4">
  <div class="d-flex flex-column align-items-stretch">
    <div class="d-flex flex-fill align-items-center gap-4 py-3 mx-4">
      <div class="align-items-center">
        <img
          src="../static/img/filter.png"
          alt="Filter"
          style="width: 20px; height: 20px"
        />
        <img
          src="../static/img/sort-arrows-couple-pointing-up-and-down.png"
          alt="Sort"
          style="width: 20px; height: 20px"
        />
      </div>
      <p class="mb-0" style="font-size: 0.75rem !important;">MOVIES, POPULAR, SCI-FI, ANIMATION (6)</p>

      <div class="align-items-center" style="margin-left: auto">
        <img
          src="../static/img/grid.png"
          alt="Grid"
          style="width: 20px; height: 20px"
        />
        <img
          src="../static/img/view.png"
          alt="View"
          style="width: 20px; height: 20px"
        />
      </div>
    </div>
  </div>
</div>

<!-- Movie List Section -->
<div class="container mt-3 px-4">
    <div class="row col-12 g-3">
            <!-- Movie Card -->
      {% for movie in movies %}
      <div class="card-group col">
        <div class="card bg-dark-blue-lighter">
          <img src="../static/posters/{{ movie.poster_main }}" class="card-img-top" alt="..." />
          <div class="card-body">
            <p class="card-title text-truncate" style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">{{ movie.title }}</p>
  
              <div class="resume-card col-12 d-flex align-items-center justify-content-between">
                  <div class="progress-section d-flex align-items-center flex-grow-1">
                    <p class="mb-0" style="font-weight: bold; font-size: 0.75rem; color: #7e7f83">{{ movie.year }}</p>
                    <span style="color: #7e7f83" class="mx-2">|</span>
                    <div>
                      <img style="height: 20px;" src="../static/img/imdb.png" alt="imdb logo">
                      <a href="#" style="font-size: 0.75rem; font-weight: bold; color: #ff7742 !important">{{ movie.imdb_rating }}</a>
                    </div>
                  </div>
                  <a href="">
                    <img src="../static/img/play.png" alt="Play" class="resume-card-icon ms-3" />
                  </a>
              </div>
              
          </div>
        </div>
      </div> <!-- End of Movie Card -->
      {% endfor %}
    </div>
  </div> <!-- End of Movie List Section -->


<!-- Genres Tab -->
<div class="container pt-3 mt-5">
    <ul
      class="nav navbar nav-pills d-flex gap-2 justify-content-center"
      id="genre-tabs"
      role="tablist"
    >
      <li class="nav-item" role="presentation">
        <button
          class="nav-link active"
          id="all-tab"
          data-bs-toggle="pill"
          type="button"
          role="tab"
        >
          All
        </button>
      </li>
      {% for genre, icon in genres %}
      <li class="nav-item" role="presentation">
        <button
          class="nav-link"
          id="{{ genre|lower }}-tab"
          data-bs-toggle="pill"
          type="button"
          role="tab"
        >
          <img
            src="../static/img/{{ icon }}"
            alt="{{ genre }} icon"
            style="width: 20px; height: 20px; margin-right: 5px"
          />
          {{ genre }}
        </button>
      </li>
      {% endfor %}
      <!-- Add more genres if you want -->
    </ul>
  </div>
  
  <div class="container px-4">
    <div class="d-flex flex-column align-items-stretch">
      <div class="d-flex flex-fill align-items-center gap-4 py-3 mx-4">
        <div class="align-items-center">
          <img
            src="../static/img/filter.png"
            alt="Filter"
            style="width: 20px; height: 20px"
          />
          <img
            src="../static/img/sort-arrows-couple-pointing-up-and-down.png"
            alt="Sort"
            style="width: 20px; height: 20px"
          />
        </div>
        <p class="mb-0" style="font-size: 0.75rem !important;">WATCHLISTS, ALL TYPES, ALL GENRES (6)</p>
  
        <div class="align-items-center" style="margin-left: auto">
          <img
            src="../static/img/grid.png"
            alt="Grid"
            style="width: 20px; height: 20px"
          />
          <img
            src="../static/img/view.png"
            alt="View"
            style="width: 20px; height: 20px"
          />
        </div>
      </div>
    </div>
  </div>
  

  <!-- Watchlist Section -->
  <div class="container mt-3 px-4">
    <div class="row col-12 g-3">
            <!-- Watchlist Card -->
      {% for watchlist in watchlists %}
      <div class="card-group col">
        <div class="card watchlist-card bg-dark-blue-lighter">
  
            <div class="poster-collage">
              {% for poster in watchlist.posters[:4] %}
                <img src="../static/posters/{{ poster }}" alt="Poster" class="poster-crop collage-{{ watchlist.posters|length }}" />
              {% endfor %}
            </div>
  
          <div class="card-body">
            <p class="card-title text-truncate" style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">{{ watchlist.title }}</p>
              <div class="resume-card col-12 d-flex align-items-center justify-content-between">
                  <div class="progress-section d-flex align-items-center flex-grow-1">
                    <div>
                      <p class="mb-0" style="font-weight: bold; font-size: 0.95rem; color: #7e7f83">{{ watchlist.film_count }}</p>
                      <p class="mb-0" style="color: #7e7f83; font-size: 10px; padding-top: none !important;">films</p>
                    </div>
                    <span style="color: #7e7f83" class="mx-2">|</span>
                    <div class="resume-card-percentage me-2 mb-0">
                      <p class="mb-0" style="font-weight: bold; font-size: 0.75rem;">{{ watchlist.watched }}%</p>
                      <p class="mb-0" style="font-size: 10px;">watched</p>
                    </div>
                  </div>
                  <a href="">
                    <img src="../static/img/play.png" alt="Play" class="resume-card-icon ms-3" />
                  </a>
              </div>
              <div class="flex-grow-1 mt-2">
                <div class="progress" style="height: 5px;">
                  <div class="progress-bar" role="progressbar" style="width: {{ watchlist.watched }}%;"></div>
                </div>
              </div>
          </div>
        </div>
      </div> <!-- End of Watchlist Card -->
      {% endfor %}
    </div>
  </div> <!-- End of Watchlist Section -->

  <!--  -->

  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script>
    const ctx = document.getElementById("pieChart").getContext("2d");
    new Chart(ctx, {
      type: "pie",
      data: {
        labels: [
          "Action",
          "Adventure",
          "Animation",
          "Fantasy",
          "Sci-Fi",
          "Documentary",
          "History",
          "Comedy",
        ],
        datasets: [
          {
            label: "Films by Genre",
            data: [156, 140, 123, 113, 81, 55, 17, 13],
            backgroundColor: [
              "#799aa7",
              "#506e9a",
              "#7e468a",
              "#942270",
              "#c12862",
              "#eb4e57",
              "#ff4217",
              "#ff7742",
            ],
            borderWidth: 1,
          },
        ],
      },
      options: {
        responsive: true,
        plugins: {
          legend: {
            position: "bottom",
            align: "start", // left-align
            labels: {
              color: "#799aa7", // change legend font color
              font: {
                size: 14,
                family: "Arial",
              },
              padding: 20,
            },
          },
        },
      },
    });
  </script>

  {% endblock %}
</div>
